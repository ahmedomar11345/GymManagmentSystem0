@inject IStringLocalizer<SharedResource> Localizer
@model GymManagmentBLL.ViewModels.MemberViewModel.MemberToUpdateViewModel
@{
    ViewData["Title"] = Localizer["EditMemberProfile"];
}

<div class="row mb-4 align-items-center mt-4">
    <div class="col-md-6">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-2">
                <li class="breadcrumb-item"><a asp-action="Index" class="text-decoration-none">@Localizer["Members"]</a></li>
                <li class="breadcrumb-item active">@Localizer["EditProfile"]</li>
            </ol>
        </nav>
        <h2 class="fw-bold mb-0">
            <i class="fas fa-user-edit text-primary me-2"></i>@Localizer["EditMemberProfile"]
        </h2>
    </div>
    <div class="col-md-6 text-md-end">
        <a asp-action="Index" class="btn btn-outline-secondary rounded-pill px-4">
            <i class="fas fa-times me-2"></i>@Localizer["Cancel"]
        </a>
    </div>
</div>

<form asp-action="Edit" method="post" enctype="multipart/form-data">
    <div asp-validation-summary="ModelOnly" class="text-danger mb-4"></div>
    <input type="hidden" asp-for="Photo" />
    <input type="hidden" asp-for="Name" />

    <div class="row g-4">
        <!-- Profile Column -->
        <div class="col-lg-4">
            <div class="premium-card p-4 text-center sticky-top shadow-sm border-0" style="top: 2rem; z-index: 10;">
                <h5 class="fw-bold mb-4">@Localizer["ProfilePhoto"]</h5>
                <div class="position-relative d-inline-block mb-4">
                    <img id="photoPreview" src="~/images/members/@Model.Photo" alt="@Model.Name" 
                         class="rounded-circle shadow-lg"
                         style="width: 180px; height: 180px; object-fit: cover; border: 4px solid #fff;" 
                         onerror="this.src='/images/members/default-avatar.png'" />
                    
                    <label for="photoInput" class="position-absolute bottom-0 end-0 bg-primary text-white rounded-circle d-flex align-items-center justify-content-center shadow" 
                           style="width: 45px; height: 45px; cursor: pointer; border: 3px solid #fff;">
                        <i class="fas fa-camera"></i>
                    </label>
                    <input type="file" id="photoInput" asp-for="PhotoFile" class="d-none" accept="image/*" />
                </div>
                
                <h4 class="fw-bold">@Model.Name</h4>
                <p class="text-secondary small mb-4">@Localizer["MemberID"]: @ViewContext.RouteData.Values["id"]</p>
                
                <div class="alert alert-info py-2 small border-0 bg-primary bg-opacity-10 text-primary mb-0">
                    <i class="fas fa-info-circle me-2"></i>@Localizer["MaxSize"]: 3MB (JPG, PNG)
                </div>
                <span asp-validation-for="PhotoFile" class="text-danger small mt-2 d-block"></span>
            </div>
        </div>

        <!-- Form Column -->
        <div class="col-lg-8">
            <!-- Personal Information -->
            <div class="premium-card p-4 mb-4 shadow-sm border-0">
                <div class="d-flex align-items-center mb-4">
                    <div class="icon-shape bg-primary bg-opacity-10 text-primary me-3">
                        <i class="fas fa-id-card"></i>
                    </div>
                    <h5 class="fw-bold mb-0">@Localizer["PersonalInformation"]</h5>
                </div>
                
                <div class="row g-3">
                    <div class="col-md-6">
                        <label asp-for="Email" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["EmailAddress"]</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light border-end-0"><i class="fas fa-envelope text-secondary"></i></span>
                            <input asp-for="Email" class="form-control border-start-0" placeholder="@Localizer["EmailPlaceholder"]" />
                        </div>
                        <span asp-validation-for="Email" class="text-danger small"></span>
                    </div>
                    
                    <div class="col-md-6">
                        <label asp-for="Phone" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["Phone"]</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light border-end-0"><i class="fas fa-phone text-secondary"></i></span>
                            <input asp-for="Phone" class="form-control border-start-0" placeholder="@Localizer["PhonePlaceholder"]" />
                        </div>
                        <span asp-validation-for="Phone" class="text-danger small"></span>
                    </div>
                    
                    <div class="col-md-6">
                        <label asp-for="DateOfBirth" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["DateOfBirth"]</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light border-end-0"><i class="fas fa-birthday-cake text-secondary"></i></span>
                            <input asp-for="DateOfBirth" type="date" class="form-control border-start-0" />
                        </div>
                        <span asp-validation-for="DateOfBirth" class="text-danger small"></span>
                    </div>
                    
                    <div class="col-md-6">
                        <label asp-for="Gender" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["Gender"]</label>
                        <div class="d-flex gap-4 mt-1">
                            @foreach (Gender gender in Enum.GetValues(typeof(Gender)))
                            {
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" asp-for="Gender" value="@gender" id="gender_@gender">
                                    <label class="form-check-label" for="gender_@gender">
                                        @Localizer[gender.ToString()]
                                    </label>
                                </div>
                            }
                        </div>
                        <span asp-validation-for="Gender" class="text-danger small"></span>
                    </div>
                </div>
            </div>

            <!-- Address Information -->
            <div class="premium-card p-4 mb-4 shadow-sm border-0">
                <div class="d-flex align-items-center mb-4">
                    <div class="icon-shape bg-success bg-opacity-10 text-success me-3">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <h5 class="fw-bold mb-0">@Localizer["ContactAddress"]</h5>
                </div>
                
                <div class="row g-3">
                    <div class="col-md-3">
                        <label asp-for="City" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["City"]</label>
                        <input asp-for="City" class="form-control" placeholder="@Localizer["CityPlaceholder"]" />
                        <span asp-validation-for="City" class="text-danger small"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="Street" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["Street"]</label>
                        <input asp-for="Street" class="form-control" placeholder="@Localizer["StreetPlaceholder"]" />
                        <span asp-validation-for="Street" class="text-danger small"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="BuildingNumber" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["BuildingNumber"]</label>
                        <input asp-for="BuildingNumber" class="form-control" placeholder="@Localizer["BuildingPlaceholder"]" />
                        <span asp-validation-for="BuildingNumber" class="text-danger small"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="Country" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["Country"]</label>
                        <input asp-for="Country" class="form-control" placeholder="@Localizer["Country"]" />
                        <span asp-validation-for="Country" class="text-danger small"></span>
                    </div>
                </div>
            </div>

            <!-- Health Record -->
            <div class="premium-card p-4 mb-4 shadow-sm border-0">
                <div class="d-flex align-items-center mb-4">
                    <div class="icon-shape bg-danger bg-opacity-10 text-danger me-3">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <h5 class="fw-bold mb-0">@Localizer["HealthStatus"]</h5>
                </div>
                
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="p-3 bg-light rounded-4">
                            <label asp-for="HealthRecord.Weight" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["WeightKg"]</label>
                            <div class="input-group">
                                <input asp-for="HealthRecord.Weight" class="form-control border-end-0" placeholder="75.0" />
                                <span class="input-group-text bg-white border-start-0 text-secondary small">@Localizer["KG"]</span>
                            </div>
                            <span asp-validation-for="HealthRecord.Weight" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="p-3 bg-light rounded-4">
                            <label asp-for="HealthRecord.Height" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["HeightCm"]</label>
                            <div class="input-group">
                                <input asp-for="HealthRecord.Height" class="form-control border-end-0" placeholder="180.0" />
                                <span class="input-group-text bg-white border-start-0 text-secondary small">@Localizer["CM"]</span>
                            </div>
                            <span asp-validation-for="HealthRecord.Height" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="p-3 bg-light rounded-4 h-100">
                            <label asp-for="HealthRecord.BloodType" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["BloodType"]</label>
                            <select asp-for="HealthRecord.BloodType" class="form-select">
                                <option value="">@Localizer["Select"]</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                            </select>
                            <span asp-validation-for="HealthRecord.BloodType" class="text-danger small"></span>
                        </div>
                    </div>
                    <div class="col-12">
                        <label asp-for="HealthRecord.Note" class="form-label fw-bold small text-uppercase text-secondary">@Localizer["MedicalNotes"]</label>
                        <textarea asp-for="HealthRecord.Note" class="form-control" rows="3" placeholder="@Localizer["MedicalNotesPlaceholder"]"></textarea>
                        <span asp-validation-for="HealthRecord.Note" class="text-danger small"></span>
                    </div>
                </div>
            </div>

            <!-- Submit Section -->
            <div class="premium-card p-4 bg-primary bg-opacity-10 border-primary border-opacity-25 shadow-sm">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="fw-bold mb-1"><i class="fas fa-save me-2 text-primary"></i>@Localizer["ReadyToSave"]</h6>
                        <p class="text-secondary small mb-0">@Localizer["ReviewChanges"]</p>
                    </div>
                    <button type="submit" class="btn btn-primary px-5 py-2 fw-bold shadow-sm rounded-pill">
                        @Localizer["UpdateProfile"]
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/member.js" asp-append-version="true"></script>
}
